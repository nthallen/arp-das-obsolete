#! /usr/bin/env ENV="" /bin/sh

#__USAGE
#%C	<node number>
#%C	<directory>
#	Runs chkfsys on the designated node's root or the designated
#	filesystem
typeset response=y fsys node
[ -z "$1" ] && echo fixdisk: No arguments specified >&2 && exit 1
fsys=$1
[ ! -d "$fsys" ] && fsys=//$fsys/
fsys=`/usr/bin/fullpath -t $fsys`
[ ! -d $fsys ] && {
  echo fixdisk: Unable to locate filesystem for $1 >&2
  exit 1
}
node=${fsys#//}
node=${node%%/*}

while [ "$response" = "y" ]; do
  /usr/bin/on -f $node /bin/chkfsys -r $fsys
  /bin/stty +echo +edit
  echo "Should we run chkfsys again? [n/y] \\c"
  read j
  response=n
  case $j in
    [yY]*) response=y;;
  esac
done
